---
title: "DM Blood CyTOF ANalysis"
author: "J. O'Connor"
date: "2023-10-30"
output: html_document
---

## R Baseline Data Analysis

This is an R Markdown document that includes the R analysis for the study population baseline data.

### Initial Data Loading and Preprocessing

The initial data is loaded


```{r}
# The Working Directory is Set
setwd("..")

#Initial Libraries are loaded

library(compositions) #Version
library(readxl)
library(datasets)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(ggfortify)
library(ggpubr)
library(stringr)
library(ggrepel)
library(mice)
library(vegan)
library(ape)
library(ggpubr)
library(rstatix)
library(cowplot)
library(pheatmap)
library(randomForest)
library(VSURF)
library(ggplot2)
library (ggpubr)
library(tidyr)
library(reshape2)
library(readxl)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
library(datasets)
library(ggplot2)
library(dplyr)
library(ggfortify)
library(factoextra)
library(httr)
library(jsonlite)
library(stringr)
library(readxl)
library(datasets)
library(ggplot2)
library(dplyr)
library(lme4)
library(lmerTest)
library(afex)
library(phyloseq)
library(qiime2R)
library(vegan)
library(ape)
library(ggpubr)
library(rstatix)
library(cowplot)
library(gridExtra)
library(ggpubr)
library(jsonlite)
library(qiime2R)
library(phyloseq)
library(readxl)
library(datasets)
library(ggplot2)
library(dplyr)
library(lme4)
library(lmerTest)
library(afex)
library(microbiome)
library(microshades)
library(speedyseq)
library(compositions) 
library(tidyr)
library(ggforce)
library(ggh4x)
library(RColorBrewer)
library(pheatmap)
library(ggrepel)
library(EnhancedVolcano)
library(mice)
library(biomformat)
library(glmmLasso)


# Necessary Functions are Sourced 
function_files <- list.files(paste0(getwd(),"/Functions"), pattern = "\\.R$", full.names = TRUE)
lapply(function_files, source)

# Metadata is pulled in from an excel file
metadata <- read_xlsx("Data/Metadata/metadata.xlsx")

####Manual MSM edits #####

#Based on individual manual characterizations we altered some unknown MSM statuses
#Below is the table with the specified MSM statuses
MSM_spec <- rbind(c("DM001", "MSM", "MSM"),
                  c("DM002", "MSM", "MSM"),
                  c("DM007", "MSM", "MSM"),
                  c("DM010", "MSM", "MSM"),
                  c("DM021", "MSW", "NonMSM"),
                  c("DM093", "MSW", "NonMSM"),
                  c("DM046", "MSM", "MSM"))
#We name the columns to match the clinical data set
colnames(MSM_spec) <- c("StudyID", "MSM_status", "MSM_status2")
MSM_spec <- as.data.frame(MSM_spec)

#We then go through the metadata and manually adjust the avlues
for (j in 1:nrow(metadata)) {
  #Is the study ID is in the table we change the values
  if (metadata$StudyID[j] %in% MSM_spec$StudyID) {
    MSM_status_j <- unique(MSM_spec$MSM_status[which(MSM_spec$StudyID==metadata$StudyID[j])])
    MSM_status2_j <- unique(MSM_spec$MSM_status2[which(MSM_spec$StudyID==metadata$StudyID[j])])
    metadata$MSM_status[j] <-MSM_status_j 
    metadata$MSM_status2[j] <-MSM_status2_j 
  }
}
#We create simpler names for the fields of interest
metadata["MSM"] <- metadata$MSM_status2
metadata["HIV"] <- paste0("HIV-",metadata$HIV_Status)
metadata["Age"] <- as.numeric((metadata$DateOfVisit-metadata$DOB)/365.25)
#We adjust rownames to be consistent (studyID combined with the timepoint)
rownames(metadata) <- paste0(metadata$StudyID,"-",metadata$TimepointNumeric)

#A Group field is been added manually to link groups based on discussions with collaborators 
metadata["Group"] <- paste0("HIV-",metadata$HIV_Status,"-",metadata$MSM_status)

#For simplicity and aesthetics positive and negative are replaces with the symbols 
metadata$Group <- gsub("-Positive-","(+)",metadata$Group)
metadata$Group <- gsub("-Negative-","(-)",metadata$Group)

#Clinical data is selected from the Metadata 
clin <- unique(metadata[which(metadata$Group %in% c("HIV(+)MSM", "HIV(-)MSM", "HIV(-)MSW")),])
clin <- as.data.frame(clin)
clin["Diet.Timepoint"] <- paste0(clin$Diet, "-", clin$TimepointNumeric)
rownames(clin) <- paste0(clin$StudyID,"-",clin$TimepointNumeric)

#Now we load the Biopsy CyToF data from an excel file
by_cytdata <- read_xlsx("Data/CyTOF/CyTOF_Data.xlsx", sheet="Master Biopsy (All)", range="A6:EA58")

#Because the excel file is fortmated such that immune cells (varibales) are the rows and samples are the columns we need to adjust for our analyses
#Also because other sample cohorts are included we only select those with diet modification IDs ("DM")
by_cytdata_all <- t(by_cytdata[,which(substr(colnames(by_cytdata), 1,2)=="DM")])

#Column names are pulled for the immune cells fields
colnames(by_cytdata_all) <- t(by_cytdata[,1])

#Rownames are generated to include the sample ID and timepoint
rownames(by_cytdata_all) <- paste0("DM",substr(rownames(by_cytdata_all),4,6),"-",substr(rownames(by_cytdata_all),nchar(rownames(by_cytdata_all)),nchar(rownames(by_cytdata_all))))
#Because "-2" in the CyTOF data corresponds to the "-3" in the metadata we adjust for joining
rownames(by_cytdata_all) <- str_replace_all(rownames(by_cytdata_all), "-2", "-3") 


#Now we want to adjoin the clinical data (metadata) to the CyTOF data (by_cytdata_all)

#We first select clinical variables of interest
clinvars <- c("StudyID", "HIV","MSM","Diet", "Gender","EnterotypeBaseline","Age","Timepoint","TimepointNumeric", "LBPNorm", "HDLNorm", "LDLNorm", "TriglyceridesNorm", "HOMAIRNorm", "IL6Norm", "CRPNorm", "Group")

#########Start with blood data################################
#We pull the intersecting IDs (not all metadata is going to have CyTOF data)
by_ids <- intersect(rownames(clin),rownames(by_cytdata_all))

#We then pull both data subsets with those IDs
meta_data_by <- clin[which(rownames(clin) %in% by_ids),which(colnames(clin) %in% clinvars)]
by_cytdata_withmet <- by_cytdata_all[which(rownames(by_cytdata_all) %in% by_ids),] 

#We then adjust the rownames to match the source data sets
rownames(meta_data_by) <- rownames(clin)[which(rownames(clin) %in% by_ids)]
rownames(by_cytdata_withmet) <- rownames(by_cytdata_all)[which(rownames(by_cytdata_all) %in% by_ids)] 

#We create a blank matrix to put in each data set
by_all <- as.data.frame(matrix("",length(by_ids), length(clinvars)+ncol(by_cytdata_withmet)))

#We then go through the ids and pull the data into the matrix
for (i in 1:length(by_ids)) {
  id_1 <- by_ids[i]
  cln_1 <- meta_data_by[which(rownames(meta_data_by)==id_1),] 
  cyt_1 <- by_cytdata_withmet[which(rownames(by_cytdata_withmet)==id_1),]
  by_all[i,] <- append(cln_1, cyt_1)
}
#We adjust the column names to match the orignal source datasets
colnames(by_all) <- append(colnames(meta_data_by), colnames(by_cytdata_withmet))
#We adjust the row names to match everything else (study ID and the timepoint)
rownames(by_all) <- paste0(by_all$StudyID,"-",by_all$TimepointNumeric)

#Now that all the raw data is combined, we want to see how many samples and features are missing values

#First we assess sample that are missing feature values
#We generate a blank matrix to add to
samp_na <- c()

#We then going through the data set to see how many features are missing for each sample (is.na)
for (s in 1:nrow(by_cytdata_withmet)) {
  #First we pull the sample ID
  samp_s <- rownames(by_cytdata_withmet)[s]
  #We see how many features are NA
  count_s <- length(which(is.na(by_cytdata_withmet[s,])))
  #We add to the dataset 
  samp_na <- rbind(samp_na, c(samp_s, count_s)) 
}

#We now convert it to a dataframe
samp_na <- as.data.frame(samp_na)

#We adjust the column names
colnames(samp_na) <- c("samp", "Count")

#Now we assess features that are missing sample values 
#We generate a blank matrix to add to
col_na <- c()
#We then going through the data set to see how many samples are missing for each feature (is.na)
for (c in 1:ncol(by_cytdata_withmet)) {
  #First we pull the feature
  col_c <- colnames(by_cytdata_withmet)[c]
  #We see how many samples are NA
  count_c <- length(which(is.na(by_cytdata_withmet[,c])))
  #We add to the dataset
  col_na <- rbind(col_na, c(col_c, count_c)) 
}

#We now convert it to a dataframe
col_na <- as.data.frame(col_na)

#We adjust the column names
colnames(col_na) <- c("col", "Count")

#We filter to include sampels and columns that are less than half unvailable 
amp_inc <- samp_na$samp[which(as.numeric(samp_na$Count)<50)]
col_inc <- col_na$col[which(as.numeric(col_na$Count)<50)]

#We generate proc (processed) and raw data sets for only the samples and columns we want to include staring first with the base meta data dnsequentially filling the columns out
by_all_proc <- by_all[which(rownames(by_all) %in% samp_inc),1:ncol(meta_data_by)]
by_all_raw <- by_all[which(rownames(by_all) %in% samp_inc),1:ncol(meta_data_by)]

#Going through the cytof data we pull in the columns in
for (j in 1:ncol(by_cytdata_withmet)) {
  #First we want to see if it is one of the columns we want to include
  if (colnames(by_cytdata_withmet)[j] %in% col_inc) {
    #If it is, we scale the column 
    normvec <- scale(as.numeric(by_all[,ncol(meta_data_by)+j]))
    #We add the scaled data to the processed data file
    by_all_proc <- cbind(by_all_proc, normvec)
    #We afdjust the column name of the new added column
    colnames(by_all_proc)[ncol(by_all_proc)] <- paste0(colnames(by_all)[ncol(meta_data_by)+j],"_Norm")
    #We add the raw data to the raw datafile
    by_all_raw <- cbind(bd=by_all_raw, as.numeric(by_all[,ncol(meta_data_by)+j]))
    #We afdjust the column name of the new added column
    colnames(by_all_raw)[ncol(by_all_raw)] <- paste0(colnames(by_all)[ncol(meta_data_by)+j],"_Raw")
  }
}
#We convert the matrices into data frames
by_all_proc <- as.data.frame(by_all_proc)
by_all_raw <- as.data.frame(by_all_raw)



#We perform an imputation using Multivariate Imputation by Chained Equations (mice)
#We pull the imputable dala (processed) but just the CYTOF fields we want to impute
n_imp_data <- by_all_proc[,(ncol(meta_data_by)+1):ncol(by_all_proc)]
#We store the original columns wehich need to be changed for the impuation
origcol <- colnames(n_imp_data)
#We rename the columns to allow for impuation
colnames(n_imp_data) <- paste0("c", 1:ncol(n_imp_data))
#We generate an impuation model
imp_model <- mice(n_imp_data)
#We use the model to omplete the data
imp_data <- complete(imp_model)
#Now a new dataset is generated that is both processed and imputed ("proc_imp")
by_all_proc_imp <- cbind(by_all_proc[which(rownames(by_all_proc) %in% samp_inc),1:ncol(meta_data_by)], imp_data)




```

###Baseline Differences by HIV and MSM Status

Below we look at differences at baseline by HIV and MSM status

```{r}
#The column names are switched back 
colnames(by_all_proc_imp)[(ncol(meta_data_by)+1):ncol(by_all_proc_imp)] <- origcol
#We initially pull baseline data 
by_all_proc_imp_1 <- by_all_proc_imp[which(by_all_proc_imp$Timepoint=="T1"),]
by_all_proc_imp_1
#First we pull MSM samples and look at differences by HIV

#First pull the MSM samples from the baseline data
by_all_proc_imp_msm_1 <- by_all_proc_imp_1[which(by_all_proc_imp_1$MSM=="MSM"),] 


#We use generate volcano plot data
hiv_volc_data_msm1 <- volc_data_generator(by_all_proc_imp_msm_1, origcol,"HIV",FALSE,TRUE,"StudyID","HIV-Positive")

print(hiv_volc_data_msm1)

#First we pull HIV samples and look at differences by MSM

#First pull the HIV samples from the baseline data
by_all_proc_imp_hivn_1 <- by_all_proc_imp_1[which(by_all_proc_imp_1$HIV=="HIV-Negative"),] 

#We use generate volcano plot data
msm_volc_data_hivn1 <- volc_data_generator(by_all_proc_imp_hivn_1,origcol,"MSM",FALSE,TRUE,"StudyID","MSM")

print(msm_volc_data_hivn1)

```

###Baseline ANOVA

Baseline ANOVA between three groups

```{r}
#We generate a anova data table to compare across the three groups 
#We pull the vaaiables from one of the volcano plot generators

anova_gp_data <- as.data.frame(hiv_volc_data_msm1[,1])

#We add data fields
#One includes the ANOVA p value
anova_gp_data["anova_p"] <- NA

#Three include the pairwise comparison adjusted p values from Tukey's test
anova_gp_data[("HIV(+)MSM vs HIV(-)MSM padj")] <- NA
anova_gp_data[("HIV(-)MSM vs HIV(-)MSW padj")] <- NA
anova_gp_data[("HIV(+)MSM vs HIV(-)MSW padj")] <- NA

#Now we go through each variable
for (v in 1:nrow(anova_gp_data)) {
  #We pull the variable name
  var_v <- as.character(anova_gp_data[v,1])
  #We subset the columns to only select the outcome and the group
  data_v <- by_all_proc_imp_1[,which(colnames(by_all_proc_imp_1) %in% c(var_v, "Group"))]
  #We rename the outcome field
  colnames(data_v)[which(colnames(data_v)==var_v)] <- "Outcome"
  data_v$Outcome <- as.numeric(data_v$Outcome)
  #A linear Regression is performed
  lm_v <- lm(Outcome ~ Group, data=data_v)
  #An anova is performed on the linear model
  anova_v <- aov(lm_v)
  #We generate one summary to pull a p value
  sum_v <- summary(anova_v)
  #We pull a p value
  anova_gp_data$anova_p[v] <- sum_v[[1]][["Pr(>F)"]][1]
  #A Tukey's test for multiple comparisons
  tukey_v <- TukeyHSD(x=anova_v, 'Group', conf.level=0.95)
  #We pull the pairwise p-values 
  tukey_padj_v <- as.data.frame(tukey_v$Group)
  tukey_padj_v["group1"] <- substr(rownames(tukey_padj_v),1,9)
  tukey_padj_v["group2"] <- substr(rownames(tukey_padj_v),11,19)
  for (r in 1:3) {
    group_1_r <- tukey_padj_v$group1[r]
    group_2_r <- tukey_padj_v$group2[r]
    for (c in 1:3) {
      col_c <- colnames(anova_gp_data)[ncol(anova_gp_data)-3+c]
      col_c_group_1 <- substr(col_c,1,9)
      col_c_group_2 <- substr(col_c,14,22)
      col_c_gps <- c(col_c_group_1, col_c_group_2)
      if (group_1_r %in% col_c_gps & group_2_r %in% col_c_gps) {
      anova_gp_data[v,(ncol(anova_gp_data)-3+c)] <- tukey_padj_v$`p adj`[r]
      }
    }
  }
}

anova_gp_data["anova_padj"] <- p.adjust(anova_gp_data$anova_p, method="bonferroni")


```


###Dietary Changes

Below we generate datasets lookng at how these change across the diets

```{r}

####First we look at the Raw Data
###Agrarian Diet 
origcol_raw <- gsub("_Norm","_Raw",origcol)
#First we pull that data
by_all_raw_ag <- by_all_raw[which(by_all_raw$Diet=="Agrarian"),]
#We change the timepoint to a character
by_all_raw_ag$Timepoint <- as.character(by_all_raw_ag$Timepoint)
#We then generate a volcano plot data of all on that diet
ag_volc_data_tm_raw <- volc_data_generator(by_all_raw_ag, origcol_raw,"Timepoint",TRUE,FALSE,"StudyID","T3")

#We generate another file to combine all the data subsets
ag_volc_data_tm_raw_subs <- ag_volc_data_tm_raw
ag_volc_data_tm_raw_subs["Subset"] <- "All"

#Now we generate individual volcano data sets for each group 
un_gps <- unique(by_all_raw$Group)
#For each group we will generate a subset and perform differential abundance analysis
for (g in un_gps) {
  #We pull that data
  ag_data_g <- by_all_raw_ag[which(by_all_raw_ag$Group==as.character(g)),]
  #We generate the volcano plot data 
  ag_g_volc <- volc_data_generator(ag_data_g, origcol_raw,"Timepoint",TRUE,FALSE,"StudyID","T3")
  #We now name the data
  ag_g_volc["Subset"] <- g
  ag_volc_data_tm_raw_subs <- rbind(ag_volc_data_tm_raw_subs, ag_g_volc)
  assign(paste0("ag_volc_data_tm_raw_",g),ag_g_volc)
}


###Western Diet 

#First we pull that data
by_all_raw_we <- by_all_raw[which(by_all_raw$Diet=="Western"),]
#We change the timepoint to a character
by_all_raw_we$Timepoint <- as.character(by_all_raw_we$Timepoint)
#We then generate a volcano plot data of all on that diet
we_volc_data_tm_raw <- volc_data_generator(by_all_raw_we, origcol_raw,"Timepoint",TRUE,FALSE,"StudyID","T3")

#We generate another file to combine all the data subsets
we_volc_data_tm_raw_subs <- we_volc_data_tm_raw
we_volc_data_tm_raw_subs["Subset"] <- "All"

#For each group we will generate a subset and perform differential abundance analysis
for (g in un_gps) {
  #We pull that data
  we_data_g <- by_all_raw_we[which(by_all_raw_we$Group==as.character(g)),]
  #We generate the volcano plot data 
  we_g_volc <- volc_data_generator(we_data_g, origcol_raw,"Timepoint",TRUE,FALSE,"StudyID","T3")
  #We now name the data
  we_g_volc["Subset"] <- g
  we_volc_data_tm_raw_subs <- rbind(we_volc_data_tm_raw_subs, we_g_volc)
  assign(paste0("we_volc_data_tm_raw_",g),we_g_volc)
}


####Then we use the Processed Data
###Agrarian Diet 

#First we pull that data
by_all_proc_imp_ag <- by_all_proc_imp[which(by_all_proc_imp$Diet=="Agrarian"),]
#We change the timepoint to a character
by_all_proc_imp_ag$Timepoint <- as.character(by_all_proc_imp_ag$Timepoint)
#We then generate a volcano plot data of all on that diet
ag_volc_data_tm_proc <- volc_data_generator(by_all_proc_imp_ag, origcol,"Timepoint",TRUE,TRUE,"StudyID","T3")

#We generate another file to combine all the data subsets
ag_volc_data_tm_proc_subs <- ag_volc_data_tm_proc
ag_volc_data_tm_proc_subs["Group"] <- "All"

#Now we generate individual volcano data sets for each group 
un_gps <- unique(by_all_proc_imp$Group)
#For each group we will generate a subset and perform differential abundance analysis
for (g in un_gps) {
  #We pull that data
  ag_data_g <- by_all_proc_imp_ag[which(by_all_proc_imp_ag$Group==as.character(g)),]
  #We generate the volcano plot data 
  ag_g_volc <- volc_data_generator(ag_data_g, origcol,"Timepoint",TRUE,TRUE,"StudyID","T3")
  #We now name the data
  ag_g_volc["Group"] <- g
  ag_volc_data_tm_proc_subs <- rbind(ag_volc_data_tm_proc_subs, ag_g_volc)
  assign(paste0("ag_volc_data_tm_proc_",g),ag_g_volc)
}


###Western Diet 

#First we pull that data
by_all_proc_imp_we <- by_all_proc_imp[which(by_all_proc_imp$Diet=="Western"),]
#We change the timepoint to a character
by_all_proc_imp_we$Timepoint <- as.character(by_all_proc_imp_we$Timepoint)
#We then generate a volcano plot data of all on that diet
we_volc_data_tm_proc <- volc_data_generator(by_all_proc_imp_we, origcol,"Timepoint",TRUE,TRUE,"StudyID","T3")

#We generate another file to combine all the data subsets
we_volc_data_tm_proc_subs <- we_volc_data_tm_proc
we_volc_data_tm_proc_subs["Group"] <- "All"

#For each group we will generate a subset and perform differential abundance analysis
for (g in un_gps) {
  #We pull that data
  we_data_g <- by_all_proc_imp_we[which(by_all_proc_imp_we$Group==as.character(g)),]
  #We generate the volcano plot data 
  we_g_volc <- volc_data_generator(we_data_g, origcol,"Timepoint",TRUE,TRUE,"StudyID","T3")
  #We now name the data
  we_g_volc["Group"] <- g
  we_volc_data_tm_proc_subs <- rbind(we_volc_data_tm_proc_subs, we_g_volc)
  assign(paste0("we_volc_data_tm_proc_",g),we_g_volc)
}


#All states combined
ag_volc_data_tm_proc_subs["Diet"] <- "Agrarian"
we_volc_data_tm_proc_subs["Diet"] <- "Western"

#We put the stats together
all_volc_data_tm_proc <- rbind(ag_volc_data_tm_proc_subs,we_volc_data_tm_proc_subs)

#Now we add groups for plotting it
all_volc_data_tm_proc["group1"] <- "T1"
all_volc_data_tm_proc["group2"] <- "T3"

all_volc_data_tm_proc_filt <- all_volc_data_tm_proc[which(!is.na(all_volc_data_tm_proc$padj) & all_volc_data_tm_proc$Group=="All"),]
all_volc_data_tm_proc_filt["p.signif"] <- add_asterisks(all_volc_data_tm_proc_filt$padj)
colnames(all_volc_data_tm_proc_filt)[1] <- "Cell"

all_volc_data_tm_proc_filt$Cell <- gsub("CD14\\+ Monocytes \\(.*\\)", "CD14+ Monocytes",all_volc_data_tm_proc_filt$Cell)

all_volc_data_tm_proc_filt$Cell <- gsub("_Norm","",all_volc_data_tm_proc_filt$Cell)
```


###Violin Plots of Select Cells

We are going to select those that were significant and plot the violin plots

```{r}

#First we select out the significant cells

sig_ag_proc_cells <- ag_volc_data_tm_proc$var_names[which(ag_volc_data_tm_proc$padj<0.05)] 

#Now we stack the data for those values 
by_all_proc_imp_sig_long <- pivot_longer(by_all_proc_imp, cols=sig_ag_proc_cells, names_to="Cell", values_to="Amount")
by_all_proc_imp_sig_long$Cell <- gsub("CD14\\+ Monocytes \\(.*\\)", "CD14+ Monocytes",by_all_proc_imp_sig_long$Cell)
by_all_proc_imp_sig_long$Cell <- gsub("_Norm","",by_all_proc_imp_sig_long$Cell)

#Now we generate a violin plot
viol_select <- ggplot(data = by_all_proc_imp_sig_long,
                      mapping = aes(x = Timepoint, y = as.numeric(Amount), fill = Diet)) +
              geom_violin() +
              geom_line(mapping = aes(group = StudyID),
                position = position_dodge(0.1),
                alpha = .3,
                size=1) +
              geom_point(mapping = aes(fill = Diet, group = StudyID),
                size = 2, shape = 21,
                position = position_dodge(0.1)) +
              scale_fill_manual(values=c("darkgreen","darkorange"))+
              labs(y="Normalized Percent of Parent")+
              theme_classic() +
              theme(legend.position = "bottom",
                legend.title = element_text(size = 20),
                legend.text = element_text(size = 20),
                axis.text.x = element_text(size = 15),
                axis.title.y = element_text(size = 20),
                axis.title.x = element_blank(),
                axis.text.y = element_text(size = 15),
                strip.text.x = element_text(size=12),
                strip.text.y = element_text(size=10),
                plot.tag = element_text(size=25),
                ggh4x.facet.nestline = element_blank(),
                strip.background.x = element_rect(
                  color="black", fill="gray", linetype="solid"
                ),
                strip.background.y = element_rect(
                  color="black", fill="gray", linetype="solid"
                )) +
                facet_nested(rows=vars(Cell),
                  cols=vars(Diet), 
                  scales="free_y")+
                stat_pvalue_manual(
                  all_volc_data_tm_proc_filt,
                  label = "p.signif",
                  hide.ns = TRUE,
                  step.increase = 0.1,
                  y.position=c(5.5,4)
                ) 
                


```
